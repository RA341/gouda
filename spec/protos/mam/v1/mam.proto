syntax = "proto3";

package mam.v1;

option go_package = "github.com/RA341/gouda/generated/mam/v1";

service MamService {
  rpc Search(Query) returns (SearchResults);
  rpc BuyVip(VipRequest) returns (VipResponse);
  rpc GetThumbnail(GetThumbnailRequest) returns (GetThumbnailResponse) {}

  rpc GetProfile(Empty) returns (UserData);
  rpc BuyBonus(BonusRequest) returns (BonusResponse);
  rpc IsMamSetup(IsMamSetupRequest) returns (IsMamSetupResponse) {}
}

message GetThumbnailRequest {
  string id = 1;
}

message GetThumbnailResponse {
  bytes imageData = 2;
}

message IsMamSetupRequest {}

message IsMamSetupResponse {}

message UserData {
  string classname = 1;
  string country_code = 2;
  string country_name = 3;
  string downloaded = 4;
  int64 downloaded_bytes = 5;
  double ratio = 6;
  int32 seedbonus = 7;
  int32 uid = 8;
  string uploaded = 9;
  int64 uploaded_bytes = 10;
  string username = 11;
  string vip_until = 12;
}

message VipRequest {
  int32 amountInWeeks = 1;
}

message VipResponse {
  bool Success = 1;
  string Type = 2;
  float Amount = 3;
  float SeedBonus = 4;
}

message BonusRequest {
  int32 amountInGB = 1;
}

message BonusResponse {
  bool Success = 1;
  string Type = 2;
  float Amount = 3;
  float Seedbonus = 4;
  int64 Uploaded = 5;
  int64 Downloaded = 6;
  string UploadFancy = 7;
  string DownloadFancy = 8;
  float Ratio = 9;
}

message SearchResults {
  repeated SearchBook results = 1;
  // total found
  int32 found = 2;
  // total results
  int32 total = 3;
}

message SearchBook {
  int32 mam_id = 1;

  string title = 2;
  string thumbnail = 3;
  repeated Author author = 4;
  repeated Author narrator = 5;
  string uploader_name = 6;
  repeated Series series = 7;
  string description = 21;

  string tags = 8;
  string date_added_iso = 9;
  bool snatched = 10;
  string language_code = 11;

  string media_category = 12;
  // genre
  int32 category_id = 13;
  string category_name = 14;

  // files extensions
  string media_format = 15;
  // size in [k/m/g]ib
  string media_size = 16;
  int32 seeders = 17;
  int32 leechers = 18;
  int32 completed = 19;

  string torrent_link = 20;
}

message Author {
  string id = 1;
  string name = 2;
}

message Series {
  string id = 1;
  string name = 2;
  string sequence_number = 3;
}

message FreeLeechInfo {
  string type = 1;    // "fl", "VIP", etc.
  string expires = 2; // Expiration date if applicable
}

message Query {
  string query = 1;
}

message Empty {}
